<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบจองคิว</title>
</head>
<body>
    <h1>ระบบจองคิว Version 2.0</h1>
    <button onclick="bookQueue()">จองคิว</button>
    <button onclick="cancelQueue()">ยกเลิกคิว</button>
    <ul id="queue-list"></ul>

    <script>
        async function bookQueue() {
            const userId = await getUserId();
            const res = await fetch(`https://script.google.com/macros/s/AKfycbx5L-iuSTqvQ1vqWXiNgh94jzeb9aOmsHtXbO5jooFWBgR59OWGebw-AL8fJq0y1myA/exec?action=bookQueue&userId=${userId}`);
            alert("จองคิวสำเร็จ!");
        }

        async function cancelQueue() {
            const userId = await getUserId();
            await fetch(`https://script.google.com/macros/s/AKfycbx5L-iuSTqvQ1vqWXiNgh94jzeb9aOmsHtXbO5jooFWBgR59OWGebw-AL8fJq0y1myA/exec?action=cancelQueue&userId=${userId}`);
            alert("ยกเลิกคิวสำเร็จ!");
        }

        async function getUserId() {
            await liff.init({ liffId: "YOUR_LIFF_ID" });
            const profile = await liff.getProfile();
            return profile.userId;
        }

        async function loadQueues() {
            const res = await fetch("https://script.google.com/macros/s/AKfycbx5L-iuSTqvQ1vqWXiNgh94jzeb9aOmsHtXbO5jooFWBgR59OWGebw-AL8fJq0y1myA/exec?action=getQueues");
            const queues = await res.json();
            const queueList = document.getElementById("queue-list");
            queueList.innerHTML = "";
            queues.forEach(queue => {
                const li = document.createElement("li");
                li.textContent = `คิวที่ ${queue.queueNo} - สถานะ: ${queue.status}`;
                queueList.appendChild(li);
            });
        }

        loadQueues();
    </script>
</body>
</html>
