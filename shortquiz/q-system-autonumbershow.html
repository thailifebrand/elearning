<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>р╕гр╕░р╕Ър╕Ър╕Ир╕нр╕Зр╕Др╕┤р╕з</title>
</head>
<body>
    <h1>ЁЯУМ р╕гр╕░р╕Ър╕Ър╕Ир╕нр╕Зр╕Др╕┤р╕з</h1>
    <button onclick="bookQueue()">ЁЯУМ р╕Ир╕нр╕Зр╕Др╕┤р╕з</button>
    <button onclick="cancelQueue()">тЭМ р╕вр╕Бр╣Ар╕ер╕┤р╕Бр╕Др╕┤р╕з</button>

    <h2>ЁЯФв р╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕Др╕┤р╕зр╕Вр╕нр╕Зр╕Др╕╕р╕У: <span id="current-queue">-</span></h2>

    <h3>ЁЯУЛ р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Др╕┤р╕зр╕Чр╕╡р╣Ир╕Ир╕нр╕З</h3>
    <ul id="queue-list"></ul>

    <script>
        const API_URL = "https://script.google.com/macros/s/AKfycbx1YJVM-rIv-9XvgnYhW_3C0RH7WjnifD9cvgH7ADNA9Y9cdWXRcKe1eEsbFmPinjj6/exec";

        async function bookQueue() {
            const res = await fetch(`${API_URL}?action=bookQueue`);
            const data = await res.json();
            document.getElementById("current-queue").textContent = data.queueNo;
            alert(`тЬЕ р╕Ир╕нр╕Зр╕Др╕┤р╕зр╕кр╕│р╣Ар╕гр╣Зр╕И! р╕лр╕бр╕▓р╕вр╣Ар╕ер╕Вр╕Др╕┤р╕зр╕Вр╕нр╕Зр╕Др╕╕р╕Ур╕Др╕╖р╕н ${data.queueNo}`);
            loadQueues();
        }

        async function cancelQueue() {
            await fetch(`${API_URL}?action=cancelQueue`);
            document.getElementById("current-queue").textContent = "-";
            alert("тЭМ р╕вр╕Бр╣Ар╕ер╕┤р╕Бр╕Др╕┤р╕зр╕кр╕│р╣Ар╕гр╣Зр╕И!");
            loadQueues();
        }

        async function loadQueues() {
            const res = await fetch(`${API_URL}?action=getQueues`);
            const queues = await res.json();
            const queueList = document.getElementById("queue-list");
            queueList.innerHTML = "";
            queues.forEach(queue => {
                const li = document.createElement("li");
                li.textContent = `р╕Др╕┤р╕зр╕Чр╕╡р╣И ${queue.queueNo} - р╕кр╕Цр╕▓р╕Щр╕░: ${queue.status}`;
                queueList.appendChild(li);
            });
        }

        loadQueues();
    </script>
</body>
</html>
